{"version":3,"sources":["webpack:///webpack/bootstrap 99e3de365a20cb5729fc","webpack:///./src/vpaid-stitcher.js"],"names":["VpaidStitcher","video","playerType","containerElem","src","tagIterator","tags","tag","startsWith","console","log","adParser","ad","nonParsedAd","join","adObj","split","reduce","acc","entry","key","replace","value","undefined","initVpaidStitcher","elem","type","jwPlayer","jwplayerInstance","jwplayer","setup","playlist","sources","file","on","data","hlsPlayer","Hls","isSupported","hls","fragLoaded","loadSource","attachMedia","Events","MANIFEST_PARSED","e","play","FRAG_CHANGED","frag","tagList","module","exports"],"mappings":"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","file":"vpaid-stitcher.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/public/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 99e3de365a20cb5729fc","const VpaidStitcher = () => {\n  let video,\n      playerType,\n      containerElem,\n      src;\n\n  const tagIterator = (tags) => {\n    for (let tag of tags) {\n      if (tag[0].startsWith('EXT-X-DATERANGE')) {\n        console.log('ad event');\n        // fire data range parser for ad\n        adParser(tag);\n        break;\n      }\n    }\n  };\n\n  const adParser = (ad) => {\n    let nonParsedAd = ad.join(),\n        adObj = {};\n\n    nonParsedAd.split('\",').reduce((acc, entry) => {\n      let key = `${entry.split('=\"')[0].replace(/-/g, \"\")}`,\n          value = entry.split('=\"')[1];\n\n      if (acc !== undefined) adObj[\"ID\"] = acc.split('=\"')[1];\n      if (value.startsWith('http,')) value = value.replace(/http,/g, \"http:\");\n\n      adObj[key] = value;\n    });\n\n    console.log(adObj);\n  };\n\n  const initVpaidStitcher = (elem, src, type) => {\n    video = elem;\n    playerType = type;\n    src = src;\n    containerElem = elem;\n\n    console.log('vpaid stitcher loaded');\n  };\n\n  const jwPlayer = (elem, src) => {\n    containerElem = elem;\n    src = src;\n    playerType = 'jwplayer';\n\n    console.log('jwplayer loads');\n\n    const jwplayerInstance = jwplayer(containerElem);\n\n    jwplayerInstance.setup({\n      playlist: [{\n        sources: [{\n          file: src\n        }]\n      }]\n    });\n\n    // Noticed performance issues with on meta event\n    jwplayer().on('meta', (data) => {\n      // TODO: JW8 to release EXT-X-DATERANGE in upcoming release, not in current version\n      console.log(data);\n    });\n  };\n\n  const hlsPlayer = (video, src) => {\n    video = video;\n    src = src;\n    playerType = 'hls';\n\n    console.log('hls loads');\n\n    if (Hls.isSupported()) {\n      let hls = new Hls(),\n          fragLoaded = false;\n\n      hls.loadSource(src);\n      hls.attachMedia(video);\n      hls.on(Hls.Events.MANIFEST_PARSED, (e, data) => {\n        video.play();\n      });\n      hls.on(Hls.Events.FRAG_CHANGED, (e, data) => {\n        tagIterator(data.frag.tagList);\n      });\n    }\n  };\n\n  return {\n    initVpaidStitcher,\n    hlsPlayer,\n    jwPlayer\n  }\n}\n\nmodule.exports = VpaidStitcher;\n\n\n\n// WEBPACK FOOTER //\n// ./src/vpaid-stitcher.js"],"sourceRoot":""}